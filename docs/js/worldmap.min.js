/*! viral-50 v0.0.1 | (c) 2020 Erik BÃ¥venstrand | MIT License | https://github.com/ErikBavenstrand/DH2321-Spotify-Project */
var world=d3.select("#world").append("svg"),g=world.append("g"),worldWidth=parseInt(d3.select(".Root__main-view").style("width")),worldHeight=parseInt(d3.select(".Root__main-view").style("height")),worldProjection=d3.geoMercator().rotate([-12,0,0]).center([0,0]).scale(worldHeight/1.3/Math.PI).translate([worldWidth/2,worldHeight/1.5]),worldGraticule=d3.geoGraticule(),worldPath=d3.geoPath().projection(worldProjection),zoom=d3.zoom().scaleExtent([1,7]).on("zoom",(function(){var t=d3.event.transform,e=worldWidth*(1-t.k),o=worldHeight*(1-t.k);t.x=Math.min(0,Math.max(e,t.x)),t.y=Math.min(0,Math.max(o,t.y)),g.selectAll("path").attr("transform",t)}));function generateWorldMap(t){g.selectAll("path").data(t.features,(function(t){return t})).enter().append("path").attr("d",worldPath).classed("defaultCountry",!0).each((function(t,e){d3.select(this).classed(t.id,!0)})).on("mouseover",(function(t,e){d3.select(this).classed("countryIsInCurrentData")&&(highlightCountryInList(t.id,!0),highlightCountryOnMap(t.id,!0))})).on("click",(function(t,e){handleCountryClickShowDetail(t.id)})).on("mouseout",(function(t,e){d3.select(this).classed("countryIsInCurrentData")&&(highlightCountryInList(t.id,!1),highlightCountryOnMap(t.id,!1))}))}function existsOnMap(t){return null!==d3.select("."+t)._groups[0][0]}function updateWorldMap(t,e,o){var n=Object.keys(t);d3.selectAll(".defaultCountry").classed("countryIsInCurrentData",!1).style("fill",null).filter((function(t){return n.indexOf(t.id)>-1})).classed("countryIsInCurrentData",!0).each((function(n){d3.select(this).style("fill",calculateColorFromValue(t[n.id][currentAttribute],e[currentAttribute],o[currentAttribute],minColor,maxColor))})),updateLegend(t,e,o)}function handleCountryClickShowDetail(t){zoomInCountry(t),isInDetailView=!0}function highlightCountryOnMap(t,e){existsOnMap(t)&&(e?g.append("path").attr("d",d3.select("."+t).attr("d")).classed("countryHighlight",!0).attr("id",t+"-highlit").attr("transform",d3.select("."+t).attr("transform")):d3.select("#"+t+"-highlit").remove())}function zoomInCountry(t){toggleDetailViewVisibility();var e=worldProjection(worldCountryZoomJSON[t]),o=e[0],n=e[1];d3.event.stopPropagation(),world.transition().duration(1500).call(zoom.transform,d3.zoomIdentity.translate(worldWidth/2,worldHeight/2).scale(1e3).translate(-o,-n))}function zoomOutCountryHideDetail(){toggleDetailViewVisibility(),d3.event.stopPropagation(),world.transition().duration(1500).call(zoom.transform,d3.zoomIdentity.scale(1))}world.call(zoom);